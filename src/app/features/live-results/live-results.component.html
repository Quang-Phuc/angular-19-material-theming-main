<section class="live-wrapper">
  <!-- TAB 7 NGÀY TRONG TUẦN -->
  <nav class="day-tabs">
    <button
      type="button"
      class="day-pill"
      *ngFor="let d of dayTabs; let i = index"
      [class.active]="i === activeDayIdx"
      (click)="setActiveDay(i)">
      {{ d }}
    </button>
  </nav>

  <!-- KẾT QUẢ HÔM NAY (ĐANG QUAY) -->
  <section class="card live-card">
    <header class="card-header">
      <div class="title">
        {{ live.regionLabel }} — {{ live.dateLabel }}
        <span class="status-dot"></span>
        <span class="status-text">{{ live.status }}</span>
      </div>
      <div class="hint">
        Ô sáng là giải đang quay • các ô đang quay nhảy số 00–99, khi dừng là số chính thức
      </div>
    </header>

    <div class="card-body">
      <div
        *ngFor="let pr of ORDER"
        class="prize-row"
        [class.current]="live.currentPrize === pr">
        <div class="p-label">{{ pr === 'DB' ? 'G.ĐB' : pr }}</div>

        <div class="p-numbers">
          <!-- Đặc biệt giữ nguyên 1 khối lớn -->
          <ng-container *ngIf="pr === 'DB'; else others">
            <div class="ball big">
              {{ live.prizes.DB[0] }}
            </div>
          </ng-container>

          <!-- Các giải khác: tách 2 số / viên -->
          <ng-template #others>
            <ng-container *ngFor="let s of live.prizes[pr]; let idx = index">
              <div
                *ngFor="let n of chunk2(s)"
                class="ball"
                [class.spin]="isSpinning(pr, idx)">
                {{ n }}
              </div>
              <span class="sep" *ngIf="idx < live.prizes[pr].length - 1">•</span>
            </ng-container>
          </ng-template>
        </div>
      </div>
    </div>
  </section>

  <!-- THỐNG KÊ ĐẦU SỐ HÔM NAY -->
  <section class="card heads-card">
    <header class="card-header">
      <div class="title">Thống kê đầu số hôm nay</div>
      <div class="hint">Tính từ toàn bộ giải đã về của {{ live.regionLabel }}</div>
    </header>
    <div class="card-body">
      <table class="heads-table">
        <thead>
        <tr>
          <th>Đầu</th>
          <th>Lô tô</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let row of headStats">
          <td class="head-cell">{{ row.head }}</td>
          <td>
            <ng-container *ngIf="row.nums.length; else none">
              <span class="pill" *ngFor="let n of row.nums">{{ n }}</span>
            </ng-container>
            <ng-template #none>
              <span class="muted">—</span>
            </ng-template>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- 4 NGÀY GẦN NHẤT -->
  <section class="card past-card">
    <header class="card-header">
      <div class="title">4 ngày gần nhất</div>
    </header>
    <div class="card-body past-body">
      <div class="past-block" *ngFor="let d of past; let i = index">
        <div class="past-title">
          {{ i === 0 ? 'Hôm qua' : i + 1 + ' ngày trước' }} — {{ d.dateLabel }}
        </div>

        <div class="past-rows">
          <div *ngFor="let pr of ORDER" class="prize-row mini">
            <div class="p-label">{{ pr === 'DB' ? 'G.ĐB' : pr }}</div>
            <div class="p-numbers">
              <ng-container *ngIf="pr === 'DB'; else pastOthers">
                <div class="ball big small">{{ d.prizes.DB[0] }}</div>
              </ng-container>
              <ng-template #pastOthers>
                <ng-container *ngFor="let s of d.prizes[pr]; let idx = index">
                  <div *ngFor="let n of chunk2(s)" class="ball small">
                    {{ n }}
                  </div>
                  <span class="sep" *ngIf="idx < d.prizes[pr].length - 1">•</span>
                </ng-container>
              </ng-template>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</section>
